# 🎬 动画演示系统 v3.0 更新说明

## ✅ 本次更新内容

### 1️⃣ 修复：删除阶段一的匹配连线
**改进前：**
- 贪心匹配时会在原图和匿名图之间画绿色虚线连接匹配的节点对

**改进后：**
- ✅ 移除了两图之间的连线
- 只通过节点边框颜色（绿色=成功，红色=失败）来表示匹配状态
- 视觉更加清晰，不会有跨图的杂乱线条

### 2️⃣ 新增：阶段二的其他方法

#### 📊 标签传播 (Label Propagation)
**原理：**
- 迭代方式传播已知节点的属性标签
- 每个未知节点采用邻居中最频繁的标签
- 重复直到收敛

**动画演示：**
- 5次迭代，每次2秒
- 每次迭代推断3个节点
- 观察标签如何像波纹一样扩散
- 推断的节点变色并加蓝色边框

**公式：**
```
Y(t+1) = D^(-1/2) A D^(-1/2) Y(t)
```

#### 🧠 GraphSAGE
**原理：**
- 通过采样和聚合邻居特征来学习节点表示
- 支持多层聚合（1-hop, 2-hop, 3-hop）
- 可处理大规模图

**动画演示：**
- 3层聚合过程
- 每层2秒
- 高亮显示当前聚合范围
- 展示k-hop邻域信息传播

**公式：**
```
h_v^(k) = σ(W · CONCAT(h_v^(k-1), AGG({h_u^(k-1), u∈N(v)})))
```

### 3️⃣ 新增：阶段三的其他防御方法

#### 🔒 k-匿名化 (k-Anonymity)
**原理：**
- 使每个节点至少与k-1个其他节点具有相同的结构特征
- 主要针对度数序列进行匿名化
- 通过添加/删除边来调整度数分布

**动画演示（5个阶段）：**
1. **分析度数分布** - 节点大小变化显示度数
2. **识别独特节点** - 高亮需要匿名化的节点
3. **添加边** - 绿色虚线表示新增的边
4. **删除边** - 红色虚线表示删除的边
5. **完成** - 度数分布已平滑

**公式：**
```
∀v, |{u : degree(u) = degree(v)}| ≥ k
```

#### 💉 噪声注入 (Noise Injection)
**原理：**
- 向图中注入虚假节点和边来混淆攻击者
- 扰动节点特征（度数、聚类系数等）
- 降低结构相似度匹配准确率

**动画演示（3个阶段）：**
1. **注入虚假节点** - 🟣 紫色节点出现
2. **注入虚假边** - 🟡 黄色虚线边出现
3. **完成** - 真假混合，难以区分

**视觉标记：**
- 🟣 紫色圆圈 = 虚假节点
- 🟡 黄色虚线 = 虚假边
- 🔵 蓝色圆圈 = 真实节点
- ⚫ 灰色实线 = 真实边

## 📊 完整方法列表

### 阶段一：身份去匿名化（4个方法）
1. ✅ 贪心特征匹配 (Greedy)
2. ✅ 匈牙利算法 (Hungarian)
3. ✅ 图核方法 (Graph Kernel)
4. ✅ DeepWalk嵌入

### 阶段二：属性推断攻击（3个方法）
1. ✅ 邻居投票推断
2. ✅ 标签传播 **(新增)**
3. ✅ GraphSAGE **(新增)**

### 阶段三：差分隐私防御（3个方法）
1. ✅ 差分隐私防御（边扰动）
2. ✅ k-匿名化 **(新增)**
3. ✅ 噪声注入 **(新增)**

## 🎨 视觉设计更新

### 图例系统扩展

**阶段二方法（属性推断）：**
- 🔴 属性A（红色填充）
- 🔵 属性B（蓝色填充）
- 🟢 属性C（绿色填充）
- ⚫ 未知属性（灰色填充）
- 💙 已推断（蓝色边框）

**k-匿名化：**
- ⚫ 原始边（灰色实线）
- 🔴 删除的边（红色虚线）
- 🟢 添加的边（绿色虚线）

**噪声注入：**
- 🔵 真实节点（蓝色圆圈）
- 🟣 虚假节点（紫色圆圈）
- ⚫ 真实边（灰色实线）
- 🟡 虚假边（黄色虚线）

## 🎯 动画时间表

| 方法 | 总时长 | 步骤 | 速度 |
|------|--------|------|------|
| 贪心匹配 | 20秒 | 10步 | 2秒/步 |
| 匈牙利算法 | 1.5秒 | 1步 | 一次性 |
| 图核方法 | 6秒 | 3步 | 2秒/步 |
| DeepWalk | 变长 | 游走 | 0.5秒/步 |
| 邻居投票 | 20秒 | 8节点 | 2.5秒/节点 |
| **标签传播** | **10秒** | **5迭代** | **2秒/迭代** |
| **GraphSAGE** | **6秒** | **3层** | **2秒/层** |
| 差分隐私 | 变长 | 边扰动 | 0.8秒/边 |
| **k-匿名化** | **10秒** | **5阶段** | **2秒/阶段** |
| **噪声注入** | **7.5秒** | **3阶段** | **2.5秒/阶段** |

## 🐛 Bug修复

1. ✅ **删除跨图连线**
   - 问题：原图和匿名图之间的绿色虚线连线视觉混乱
   - 修复：完全移除连线，只用边框颜色表示匹配状态

2. ✅ **属性推断后颜色同步**
   - 确保节点数据（`d.attribute`, `d.known`）与视觉同步

3. ✅ **图例动态更新**
   - 根据当前选择的方法显示对应的图例

## 💻 技术实现

### 新增动画函数

1. **`animateLabelPropagation()`**
   - 5次迭代循环
   - 每次处理3个未知节点
   - 使用 `setInterval` 控制时间
   - 400ms延迟显示每个节点变化

2. **`animateGraphSAGE()`**
   - 3层聚合过程
   - 高亮k-hop邻域
   - 简化展示聚合范围

3. **`animateKAnonymity()`**
   - 5阶段演示
   - 动态修改节点大小表示度数
   - 添加/删除边的视觉效果

4. **`animateNoiseInjection()`**
   - 3阶段注入
   - 紫色虚假节点
   - 黄色虚假边
   - 渐变出现动画

### CSS新增类

```css
.fake-node {
    fill: #9C27B0;  /* 紫色 */
    opacity: 0.7;
}

/* 黄色虚假边在JS中动态设置 */
stroke: #FFC107;
stroke-dasharray: 5,5;
```

## 🚀 使用方法

```bash
./run_animated_demo.sh
```

访问：http://localhost:8888/animated_attack_demo.html

### 操作流程
1. 选择阶段（一/二/三）
2. 点击方法按钮
3. 阅读原理说明
4. 点击"开始演示"
5. 观看动画演示

### 交互提示
- 🖱️ 拖拽节点调整位置
- 🔍 滚轮缩放视图
- 💡 悬停查看节点详情
- ⏸ 暂停/重置动画

## 📈 系统统计

- **总方法数**: 10个
- **动画总数**: 10个
- **代码行数**: ~1500行
- **支持阶段**: 3个
- **颜色编码**: 8种状态

## 🎓 教育价值

### 为什么添加这些方法？

1. **标签传播** - 展示迭代算法如何扩散信息
2. **GraphSAGE** - 介绍图神经网络的基本思想
3. **k-匿名化** - 展示结构匿名化的经典方法
4. **噪声注入** - 演示混淆策略的防御效果

### 学习要点

- 不同方法的原理差异
- 攻击与防御的对抗关系
- 隐私保护的代价（效用vs隐私）
- 图算法的可视化理解

## 📝 更新日志

### v3.0 (2025-01-02)
- ✅ 删除阶段一匹配连线
- ✅ 新增标签传播演示
- ✅ 新增GraphSAGE演示
- ✅ 新增k-匿名化演示
- ✅ 新增噪声注入演示
- ✅ 更新图例系统
- ✅ 扩展原理说明

### v2.0 (2025-01-02)
- 三阶段分类
- 匹配成功/失败高亮
- 属性颜色系统
- DeepWalk确认

### v1.0 (2025-01-01)
- 初始版本
- 6个基础方法

---

**最后更新**: 2025-01-02
**系统版本**: v3.0
**方法总数**: 10个
