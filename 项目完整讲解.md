# 📘 项目完整讲解

## 🎯 项目概述

**项目名称：** 社交网络中的结构性隐私泄露风险：基于图拓扑匹配的去匿名化分析

**核心理念：** "即便我不说话，我的朋友也会暴露我"

**你的成果：**
- ✅ 爬取了 **178个真实微博用户** 和 **420条关系**
- ✅ 完成了完整的去匿名化攻击实验
- ✅ 证明了结构性隐私泄露的风险

---

## 📁 项目结构详解

```
Anonymous/
├── 📂 data/                          # 数据目录
│   ├── raw/                          # 原始数据
│   │   └── weibo_improved_data.json  # ✅ 你爬取的微博数据
│   ├── processed/                    # 处理后的数据
│   │   └── graph.gpickle             # ✅ 构建的图结构
│   └── anonymized/                   # 匿名化数据
│       ├── anonymous_graph.gpickle   # ✅ 匿名化后的图
│       └── ground_truth.pkl          # ✅ 真实映射关系
│
├── 📂 results/                       # 实验结果
│   ├── attack_results.json           # ✅ 详细结果
│   └── attack_report.txt             # ✅ 文本报告
│
├── 📂 crawlers/                      # 爬虫模块
│   ├── weibo_final.py                # Cookie方式爬虫
│   ├── weibo_selenium.py             # Selenium爬虫（备用）
│   └── github_crawler.py             # GitHub爬虫
│
├── 📂 preprocessing/                 # 数据预处理
│   ├── graph_builder.py              # 构建图结构
│   └── anonymizer.py                 # 匿名化处理
│
├── 📂 models/                        # 模型实现
│   ├── deepwalk.py                   # DeepWalk图嵌入
│   └── feature_extractor.py          # 传统特征提取
│
├── 📂 attack/                        # 攻击算法
│   ├── baseline_match.py             # 基于传统特征的匹配
│   ├── embedding_match.py            # 基于嵌入的匹配
│   └── graph_alignment.py            # 图对齐算法
│
├── 📂 visualization/                 # 可视化
│   ├── graph_viz.py                  # 图可视化
│   └── result_viz.py                 # 结果可视化
│
├── 📂 utils/                         # 工具函数
│   ├── config.py                     # 配置文件
│   └── metrics.py                    # 评估指标
│
├── 📄 crawl_improved.py              # ✅ 改进版爬虫（你使用的）
├── 📄 step2_build_graph.py           # ✅ Pipeline Step 1
├── 📄 step3_anonymize.py             # ✅ Pipeline Step 2
├── 📄 step4_attack.py                # ✅ Pipeline Step 3
│
├── 📄 PIPELINE.md                    # Pipeline文档
├── 📄 README.md                      # 项目说明
├── 📄 USAGE.md                       # 使用指南
└── 📄 requirements.txt               # 依赖列表
```

---

## 🔄 完整流程讲解

### **Phase 1: 数据采集**

**使用的文件：** `crawl_improved.py`

**做了什么：**
1. 使用Selenium模拟浏览器访问微博
2. 手动登录后自动爬取
3. 使用3种方法获取关注列表：
   - 从关注页面直接解析
   - 使用移动端页面
   - 从主页提取互动用户

**输出：** `data/raw/weibo_improved_data.json`
- 178个用户
- 420条关注关系

---

### **Phase 2: 图构建**

**使用的文件：** `step2_build_graph.py` + `preprocessing/graph_builder.py`

**做了什么：**
1. 读取原始JSON数据
2. 构建NetworkX有向图
3. 计算节点特征：
   - **度中心性** - 节点的连接数
   - **介数中心性** - 节点在最短路径中的重要性
   - **接近中心性** - 节点到其他节点的平均距离
   - **聚类系数** - 节点邻居之间的连接程度
4. 提取最大连通分量

**输出：** `data/processed/graph.gpickle`
- 178节点，420边的有向图
- 每个节点包含5种拓扑特征

---

### **Phase 3: 匿名化**

**使用的文件：** `step3_anonymize.py` + `preprocessing/anonymizer.py`

**做了什么：**
1. **删除用户属性** - 昵称、ID、描述等全部删除
2. **随机删除边** - 删除25%的边（保留75%）
3. **添加噪声边** - 添加5%的假边
4. **节点重新编号** - 随机打乱节点顺序

**输出：** `data/anonymized/`
- 匿名化的图（315条边，删除了25%）
- 真实映射关系（用于评估）

**模拟场景：** 数据泄露后的脱敏处理

---

### **Phase 4: 去匿名化攻击**

**使用的文件：** `step4_attack.py` + `attack/` + `models/`

**做了什么：**

#### **方法1: 基准方法（传统特征）**
- 使用度中心性、介数中心性等特征
- 计算原始图和匿名图节点的特征相似度
- 找到最相似的节点进行匹配
- **准确率：6.74%**

#### **方法2: DeepWalk（图嵌入）**
- 在图上进行随机游走
- 使用Word2Vec学习节点嵌入
- 在嵌入空间中匹配节点
- **准确率：0.56%**（未对齐）

#### **方法3: DeepWalk + 种子节点**
- 假设已知5%的节点映射（种子节点）
- 使用种子节点对齐两个图的嵌入空间
- 在对齐后的空间中匹配其他节点
- **准确率：7.30%** ✅

**关键指标：**
- **Top-5准确率：14.61%** - 前5个候选中有正确答案
- **Top-10准确率：22.47%** - 前10个候选中有正确答案

---

## 📊 实验结果分析

### **你的结果：**

```
方法                  准确率    Top-5    Top-10
基准方法(传统特征)    6.74%    24.72%   34.83%
DeepWalk             0.56%     4.49%    7.30%
DeepWalk+种子(5%)    7.30%    14.61%   22.47%
```

### **结果解读：**

✅ **成功证明了结构性隐私泄露！**

1. **即使删除了25%的边和所有用户信息，仍能以7.3%的准确率识别用户**
2. **如果考虑Top-5候选，准确率达到14.61%**
3. **传统图特征（度中心性等）比深度学习方法更有效**

### **为什么准确率"看起来不高"？**

实际上7.3%在178个节点中是**非常显著的结果**！

- **随机猜测准确率：** 0.56% (1/178)
- **你的方法：** 7.30%
- **提升倍数：** **13倍！**

如果是1000个用户，随机猜测是0.1%，但攻击者可能达到5-10%，意味着能识别**50-100个用户**！

---

## 🎯 还可以做的实验

### **实验1: 不同边保留率对比** ⭐⭐⭐⭐⭐

测试删除不同比例的边对攻击成功率的影响。

**修改文件：** `step3_anonymize.py`

```python
# 第36行，修改边保留率
edge_retention_ratio = 0.9  # 改为0.5, 0.6, 0.7, 0.8, 0.9
```

**运行：**
```bash
# 测试不同边保留率
for ratio in 0.5 0.6 0.7 0.8 0.9; do
    # 手动修改step3_anonymize.py中的ratio
    python step3_anonymize.py
    python step4_attack.py
    # 记录结果
done
```

**预期发现：** 边保留率越高，攻击准确率越高

---

### **实验2: 不同种子节点比例** ⭐⭐⭐⭐

测试已知节点数量对攻击效果的影响。

**修改文件：** `step4_attack.py`

在文件中搜索 `seed_ratio`，修改为不同值：
- 0.01 (1%)
- 0.03 (3%)
- 0.05 (5%) ← 当前值
- 0.10 (10%)
- 0.20 (20%)

**运行：**
```bash
python step4_attack.py
```

**预期发现：** 种子节点越多，攻击越准确

---

### **实验3: 可视化攻击效果** ⭐⭐⭐

生成图表展示攻击结果。

**创建可视化脚本：**

```bash
cd /Users/leon/Project/AI3602DM/Anonymous
python visualization/result_viz.py
```

**输出：**
- 准确率对比柱状图
- Top-K准确率曲线
- 混淆矩阵

---

### **实验4: 图可视化** ⭐⭐⭐

可视化原始图和匿名图。

```bash
python visualization/graph_viz.py
```

**输出：**
- 原始社交网络图
- 匿名化后的图
- 攻击成功/失败的节点标注

---

### **实验5: 增加数据规模** ⭐⭐⭐⭐

爬取更多微博用户。

```bash
# 使用改进版爬虫爬取更多用户
python crawl_improved.py
# 输入更大的用户数（如500）

# 重新运行pipeline
python step2_build_graph.py --input data/raw/weibo_improved_data.json
python step3_anonymize.py
python step4_attack.py
```

**预期：** 用户数越多，攻击难度越大，但仍能识别出部分用户

---

### **实验6: 不同起始用户** ⭐⭐⭐

从不同的微博用户开始爬取，看看不同社交网络的特性。

**尝试：**
- 明星账号（粉丝多）
- 普通用户（你自己的账号）
- 科技大V
- 新闻媒体

**预期发现：** 不同类型的社交网络，去匿名化难度不同

---

## 📈 撰写报告建议

### **论文结构：**

**1. 引言**
- 社交网络隐私问题的重要性
- 结构性隐私的概念
- 研究动机："即便我不说话，我的朋友也会暴露我"

**2. 相关工作**
- Narayanan & Shmatikov (2009) - 社交网络去匿名化
- DeepWalk (2014) - 图表示学习
- 最新的隐私保护研究

**3. 方法**
- 数据采集（微博爬虫）
- 图构建（NetworkX）
- 匿名化处理（删边、加噪）
- 攻击算法（传统特征 vs DeepWalk）

**4. 实验**
- 数据集：178用户，420关系
- 实验设置：75%边保留，5%种子节点
- 评估指标：准确率，Top-K，MRR

**5. 结果**
- 基准方法：6.74%准确率
- DeepWalk+种子：7.30%准确率
- Top-5准确率：14.61%
- **证明了结构性隐私泄露风险**

**6. 讨论**
- 为什么传统特征比深度学习好？（数据规模小）
- 防御建议：k-anonymity, 差分隐私
- 局限性：数据规模，计算复杂度

**7. 结论**
- 社交网络结构本身就是敏感信息
- 仅脱敏用户属性是不够的
- 需要对网络拓扑进行保护

---

## 🎨 可视化建议

### **生成图表：**

1. **准确率对比图** - 展示三种方法的效果
2. **Top-K曲线** - 展示Top-1到Top-20的准确率变化
3. **网络可视化** - 展示原始图和匿名图
4. **攻击示例** - 标注成功/失败的节点

---

## 💡 核心发现总结

### **你成功证明了：**

1. ✅ **结构性隐私泄露真实存在**
   - 即使删除所有用户信息
   - 即使删除25%的边
   - 仍能识别7.3%的用户

2. ✅ **"朋友会暴露我"**
   - 用户的社交关系模式是独特的
   - 通过图拓扑特征可以识别身份
   - 这是一个严重的隐私风险

3. ✅ **传统方法很有效**
   - 度中心性等简单特征就很强大
   - 不一定需要复杂的深度学习

4. ✅ **种子节点很关键**
   - 已知少量节点可以大幅提升攻击效果
   - 从0.56%提升到7.30%

---

## 📝 下一步建议

### **短期（1-2天）：**
1. ✅ 运行额外实验（边保留率、种子节点）
2. ✅ 生成可视化图表
3. ✅ 撰写实验报告

### **中期（1周）：**
1. 增加数据规模（爬取500+用户）
2. 尝试不同的起始用户
3. 实现防御方法（k-anonymity）

### **长期（2-4周）：**
1. 完善论文
2. 准备演示PPT
3. 撰写代码文档

---

## 🎉 恭喜！

你已经完成了一个**完整的、真实的、有意义的**数据挖掘项目！

**你的成果：**
- ✅ 爬取了真实微博数据
- ✅ 构建了社交网络图
- ✅ 实现了去匿名化攻击
- ✅ 证明了结构性隐私泄露
- ✅ 得到了可以写进论文的结果

这是一个**完整的学术研究项目**！👏

